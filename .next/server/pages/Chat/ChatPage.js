"use strict";(()=>{var e={};e.id=245,e.ids=[245,888,660],e.modules={7822:(e,t,r)=>{r.r(t),r.d(t,{config:()=>P,default:()=>_,getServerSideProps:()=>v,getStaticPaths:()=>f,getStaticProps:()=>S,reportWebVitals:()=>j,routeModule:()=>k,unstable_getServerProps:()=>y,unstable_getServerSideProps:()=>T,unstable_getStaticParams:()=>R,unstable_getStaticPaths:()=>C,unstable_getStaticProps:()=>w});var a={};r.r(a),r.d(a,{default:()=>Chat_ChatPage});var s=r(7379),l=r(2912),n=r(3770),o=r(6833),i=r.n(o),c=r(4496),u=r.n(c),d=r(997),p=r(6689),x=r(2589),h=r(3592),g=r(4883),b=r(4764),m=r(850);let Chat_ChatPage=()=>{let[e,t]=(0,p.useState)(!1),[r,a]=(0,p.useState)(null),[s,l]=(0,p.useState)(null),[n,o]=(0,p.useState)(null),i=(0,p.useRef)(null),c=(0,p.useRef)([]),convertSpeechToText=async e=>{let t=new FormData;t.append("file",e,"voiceMessage.webm");try{let e=await fetch("/api/speech-to-text",{method:"POST",body:t});if(!e.ok)throw Error("음성 변환 실패");let r=await e.json();return r.text||""}catch(e){return console.error("음성 변환 에러:",e),""}},startRecording=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),r=new MediaRecorder(e);i.current=r,c.current=[],r.ondataavailable=e=>{c.current.push(e.data)},r.onstop=async()=>{let e=new Blob(c.current,{type:"audio/webm"});a(e);let t=await convertSpeechToText(e);l(t);let r=URL.createObjectURL(e);o(r)},r.start(),t(!0)}catch(e){console.error("마이크 접근 실패:",e)}},stopRecording=()=>{i.current?.stop(),t(!1)};return(0,d.jsxs)("div",{className:"flex flex-col w-full h-screen bg-[#F5F8FF] py-6 px-[1rem]",children:[d.jsx(b.default,{}),d.jsx(x.default,{}),s&&d.jsx(m.default,{text:s,audioUrl:n||void 0}),n&&d.jsx("div",{className:"mt-4 text-center",children:d.jsx("audio",{controls:!0,src:n})}),d.jsx("div",{className:"text-center mt-auto",children:e?d.jsx(g.default,{onStopClick:()=>{stopRecording()},onSendClick:()=>{stopRecording()}}):d.jsx("button",{onClick:()=>{startRecording()},children:d.jsx(h.default,{})})})]})},_=(0,n.l)(a,"default"),S=(0,n.l)(a,"getStaticProps"),f=(0,n.l)(a,"getStaticPaths"),v=(0,n.l)(a,"getServerSideProps"),P=(0,n.l)(a,"config"),j=(0,n.l)(a,"reportWebVitals"),w=(0,n.l)(a,"unstable_getStaticProps"),C=(0,n.l)(a,"unstable_getStaticPaths"),R=(0,n.l)(a,"unstable_getStaticParams"),y=(0,n.l)(a,"unstable_getServerProps"),T=(0,n.l)(a,"unstable_getServerSideProps"),k=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/Chat/ChatPage",pathname:"/Chat/ChatPage",bundlePath:"",filename:""},components:{App:u(),Document:i()},userland:a})},4764:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Topbar});var a=r(997),s=r(4661);let l={src:"/_next/static/media/Close.2e3525f6.svg",height:32,width:32,blurWidth:0,blurHeight:0},Topbar=()=>{let e=(0,s.useNavigate)();return a.jsx("div",{className:"w-full h-[3.25rem] flex justify-end items-center",children:a.jsx("button",{onClick:()=>{e("/home")},"aria-label":"Close",children:a.jsx(l,{})})})}},850:(e,t,r)=>{r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var a=r(997),s=r(6689),l=r.n(s);let __WEBPACK_DEFAULT_EXPORT__=({text:e,audioUrl:t})=>{let r=l().useRef(null);return(0,a.jsxs)("div",{className:"max-w-[70%] bg-blue-500 text-white p-3 rounded-lg mb-2 self-end",children:[a.jsx("p",{children:e}),t&&a.jsx("button",{onClick:()=>{r.current?.play()},className:"mt-2 bg-blue-700 px-3 py-1 rounded text-sm",children:"듣기 ▶"}),t&&a.jsx("audio",{ref:r,src:t})]})}},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},4661:e=>{e.exports=require("react-router-dom")},997:e=>{e.exports=require("react/jsx-runtime")},1017:e=>{e.exports=require("path")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[689,833,496,674,589,19,592],()=>__webpack_exec__(7822));module.exports=r})();